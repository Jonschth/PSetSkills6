---
title: "PSetSkills6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(lubridate)
library(base)
library(tidyverse)

```

1.1
```{r}
f1 <-function(x) {
  if (length(x)<3){
    "error"
  } else
  paste0(x[1],",",x[2]," and ",x[3])
}

f1(c("a","b","c"))

```
1.2
```{r}

now()




start = as.Date("1948-12-07")
end = as.Date(now())
end

floor(as.numeric(difftime(end, start, unit="weeks")) / 52.25)


f2 <-function(start) {
  end=as.Date(now())
  floor(as.numeric(difftime(end, start, unit="weeks")) / 52.25)
}

my_birthday=("1996-04-09")

f2(my_birthday)

```

1.3.a


}
```{r}

variance <- function(x, na.rm = TRUE) {
  n <- length(x)
  m <- mean(x, na.rm = TRUE)
  err2 <- (x - m)^2
  sum(err2) / (n - 1)
  
}


x=c(1,2,3,4)

variance(x)
```
1.3.b


```{r}

skewness <- function(x, na.rm = FALSE) {
  n <- length(x)
  m <- mean(x, na.rm = na.rm)
  v <- var(x, na.rm = na.rm)
  (sum((x - m) ^ 3) / (n - 2)) / v ^ (3 / 2)
}


x=c(1,2,3,4,8)

skewness(x)

```

1.3.c



```{r}

stats_summary <- function(df){
  df_1 <- df %>% 
    summarise_if(is.numeric, mean, na.rm = TRUE) %>% 
    as.data.frame( row.name = "mean")
  
  
  df_2 <-df %>%
    summarise_if(is.numeric, variance, na.rm = TRUE) %>% 
    as.data.frame( row.name = "")


  df_3 <-df %>%
    summarise_if(is.numeric, skewness, na.rm = TRUE) %>% 
    as.data.frame( row.name = "skewness")

  df_4 <-rbind(df_1,df_2,df_3)
}

view(stats_summary(diamonds))
             

```

